\hypertarget{main_8cpp}{}\doxysection{arm9/source/main.cpp File Reference}
\label{main_8cpp}\index{arm9/source/main.cpp@{arm9/source/main.cpp}}
{\ttfamily \#include $<$nds.\+h$>$}\newline
{\ttfamily \#include $<$dirent.\+h$>$}\newline
{\ttfamily \#include $<$unistd.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdarg.\+h$>$}\newline
{\ttfamily \#include $<$time.\+h$>$}\newline
{\ttfamily \#include \char`\"{}gbgfx.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gbcpu.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}inputhelper.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}filechooser.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}timer.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gbsnd.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gameboy.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mmu.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}main.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}console.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}nifi.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}cheats.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gbs.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}common.\+h\char`\"{}}\newline
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{main_8cpp_a5e9496c777a9b87b88b024e86e1df765}{fifo\+Value32\+Handler}} (u32 value, void $\ast$user\+\_\+data)
\begin{DoxyCompactList}\small\item\em Handle 32-\/bit FIFO messages. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{main_8cpp_a54add63a62b11f9bccd4975da8fdd99c}{select\+Rom}} ()
\begin{DoxyCompactList}\small\item\em Loads a ROM file and initializes the Gameboy emulator for the first time. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{main_8cpp_a4476c89fd8b9a0783c75f891a47c535e}{init\+GBMode}} ()
\begin{DoxyCompactList}\small\item\em This function initializes the Game Boy mode based on the current ROM\textquotesingle{}s header values. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{main_8cpp_a78e04af5145ec29fb32527bd0bb749f9}{init\+GBCMode}} ()
\begin{DoxyCompactList}\small\item\em This function initializes the Game Boy Color mode based on the current ROM\textquotesingle{}s header values. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{main_8cpp_aa1e7d84951bad6e6c0e5b0962495a2d5}{initialize\+Gameboy}} ()
\begin{DoxyCompactList}\small\item\em Initializes the Gameboy emulator and sets the resulting GB mode depending on the game type and user preferences. This function initializes the Gameboy emulator by enabling sleep mode, setting frame counter to zero, and initializing the SGB mode to false. Depending on the type of game being loaded and the user\textquotesingle{}s preferences, the resultant GB mode is determined either as GB, GBC, or SGB. MMU, CPU, LCD, GFX, and SND are also initialized and GBS mode is handled accordingly. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{main_8cpp_a4429766953b588702b57e002f24122a1}{initialize\+Gameboy\+First\+Time}} ()
\begin{DoxyCompactList}\small\item\em Initializes the Gameboy system for the first time. If SGB borders are enabled, sets probing\+For\+Border flag to true, which will be ignored if starting in SGB mode or if there is no SGB mode. Then sets sgb\+Border\+Loaded flag to false, which effectively unloads any SGB border. Calls \mbox{\hyperlink{main_8cpp_aa1e7d84951bad6e6c0e5b0962495a2d5}{initialize\+Gameboy()}} to continue with Gameboy initialization. If in GBS mode, disables several menu options related to save states. Otherwise, enables menu options related to save states and the ability to exit without saving. If the GBC BIOS exists, enables the option to load it from the menu. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{main_8cpp_a0ddf1224851353fc92bfbff6f499fa97}{main}} (int argc, char $\ast$argv\mbox{[}$\,$\mbox{]})
\begin{DoxyCompactList}\small\item\em Main function for the Gameboy emulator. This function initializes the emulator by setting various parameters and calling the necessary initialization functions. It also loads a ROM file if passed as a command-\/line argument, otherwise it prompts the user to select a ROM file. Finally, it runs the emulator by calling the \mbox{\hyperlink{gameboy_8h_a81597fe9593afa9524041c128e8c9517}{run\+Emul()}} function and returns 0 when finished. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
time\+\_\+t \mbox{\hyperlink{main_8cpp_a2e99c78e3943a1e70d5e79a314aee490}{raw\+Time}}
\item 
time\+\_\+t \mbox{\hyperlink{main_8cpp_ad0ebda86ffac57ba19597a1233125129}{last\+Raw\+Time}}
\item 
volatile \mbox{\hyperlink{struct_shared_data}{Shared\+Data}} $\ast$ \mbox{\hyperlink{main_8cpp_a2bb32c52cb5d21be737aaa2aefb353d4}{shared\+Data}}
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{main_8cpp_a5e9496c777a9b87b88b024e86e1df765}\label{main_8cpp_a5e9496c777a9b87b88b024e86e1df765}} 
\index{main.cpp@{main.cpp}!fifoValue32Handler@{fifoValue32Handler}}
\index{fifoValue32Handler@{fifoValue32Handler}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{fifoValue32Handler()}{fifoValue32Handler()}}
{\footnotesize\ttfamily void fifo\+Value32\+Handler (\begin{DoxyParamCaption}\item[{u32}]{value,  }\item[{void $\ast$}]{user\+\_\+data }\end{DoxyParamCaption})}



Handle 32-\/bit FIFO messages. 

This function is used to handle 32-\/bit FIFO messages, specifically to signal sleep mode starting or ending.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em value} & The 32-\/bit value. \\
\hline
\mbox{\texttt{ in}}  & {\em user\+\_\+data} & Pointer to user-\/defined data.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{gameboy_8h_a7512b02909147a8b26c34c8a272ee93d}{pause\+Gameboy()}}, \mbox{\hyperlink{gameboy_8h_a04f739b2c98ebfeee00219477d8bdd93}{is\+Gameboy\+Paused()}}, \mbox{\hyperlink{gameboy_8h_a2048c5bce6dc06e8f6f23d7983aeb4bd}{unpause\+Gameboy()}} 
\end{DoxySeeAlso}
\texorpdfstring{$<$}{<} The scaling value before entering sleep mode.

\texorpdfstring{$<$}{<} The sound state before entering sleep mode.

\texorpdfstring{$<$}{<} Whether the Game Boy was paused before entering sleep mode.

Definition at line \mbox{\hyperlink{main_8cpp_source_l00041}{41}} of file \mbox{\hyperlink{main_8cpp_source}{main.\+cpp}}.

\mbox{\Hypertarget{main_8cpp_a78e04af5145ec29fb32527bd0bb749f9}\label{main_8cpp_a78e04af5145ec29fb32527bd0bb749f9}} 
\index{main.cpp@{main.cpp}!initGBCMode@{initGBCMode}}
\index{initGBCMode@{initGBCMode}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{initGBCMode()}{initGBCMode()}}
{\footnotesize\ttfamily void init\+GBCMode (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



This function initializes the Game Boy Color mode based on the current ROM\textquotesingle{}s header values. 

It checks if the SGB mode option is set to 2 and if the ROM header contains the SGB identifier. If both conditions are met, it sets the Game Boy Color mode to SGB (Super Game Boy) mode. Otherwise, it sets the Game Boy Color mode to GBC (Game Boy Color) mode.

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{main_8cpp_source_l00145}{145}} of file \mbox{\hyperlink{main_8cpp_source}{main.\+cpp}}.

\mbox{\Hypertarget{main_8cpp_a4476c89fd8b9a0783c75f891a47c535e}\label{main_8cpp_a4476c89fd8b9a0783c75f891a47c535e}} 
\index{main.cpp@{main.cpp}!initGBMode@{initGBMode}}
\index{initGBMode@{initGBMode}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{initGBMode()}{initGBMode()}}
{\footnotesize\ttfamily void init\+GBMode (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



This function initializes the Game Boy mode based on the current ROM\textquotesingle{}s header values. 

It checks if the SGB mode option is enabled and if the ROM header contains the SGB identifier. If both conditions are met, it sets the Game Boy mode to SGB (Super Game Boy) mode. Otherwise, it sets the Game Boy mode to GB (Game Boy) mode.

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{main_8cpp_source_l00126}{126}} of file \mbox{\hyperlink{main_8cpp_source}{main.\+cpp}}.

\mbox{\Hypertarget{main_8cpp_aa1e7d84951bad6e6c0e5b0962495a2d5}\label{main_8cpp_aa1e7d84951bad6e6c0e5b0962495a2d5}} 
\index{main.cpp@{main.cpp}!initializeGameboy@{initializeGameboy}}
\index{initializeGameboy@{initializeGameboy}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{initializeGameboy()}{initializeGameboy()}}
{\footnotesize\ttfamily void initialize\+Gameboy (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Initializes the Gameboy emulator and sets the resulting GB mode depending on the game type and user preferences. This function initializes the Gameboy emulator by enabling sleep mode, setting frame counter to zero, and initializing the SGB mode to false. Depending on the type of game being loaded and the user\textquotesingle{}s preferences, the resultant GB mode is determined either as GB, GBC, or SGB. MMU, CPU, LCD, GFX, and SND are also initialized and GBS mode is handled accordingly. 

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{main_8cpp_source_l00163}{163}} of file \mbox{\hyperlink{main_8cpp_source}{main.\+cpp}}.

\mbox{\Hypertarget{main_8cpp_a4429766953b588702b57e002f24122a1}\label{main_8cpp_a4429766953b588702b57e002f24122a1}} 
\index{main.cpp@{main.cpp}!initializeGameboyFirstTime@{initializeGameboyFirstTime}}
\index{initializeGameboyFirstTime@{initializeGameboyFirstTime}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{initializeGameboyFirstTime()}{initializeGameboyFirstTime()}}
{\footnotesize\ttfamily void initialize\+Gameboy\+First\+Time (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Initializes the Gameboy system for the first time. If SGB borders are enabled, sets probing\+For\+Border flag to true, which will be ignored if starting in SGB mode or if there is no SGB mode. Then sets sgb\+Border\+Loaded flag to false, which effectively unloads any SGB border. Calls \mbox{\hyperlink{main_8cpp_aa1e7d84951bad6e6c0e5b0962495a2d5}{initialize\+Gameboy()}} to continue with Gameboy initialization. If in GBS mode, disables several menu options related to save states. Otherwise, enables menu options related to save states and the ability to exit without saving. If the GBC BIOS exists, enables the option to load it from the menu. 

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{main_8cpp_source_l00230}{230}} of file \mbox{\hyperlink{main_8cpp_source}{main.\+cpp}}.

\mbox{\Hypertarget{main_8cpp_a0ddf1224851353fc92bfbff6f499fa97}\label{main_8cpp_a0ddf1224851353fc92bfbff6f499fa97}} 
\index{main.cpp@{main.cpp}!main@{main}}
\index{main@{main}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}\item[{int}]{argc,  }\item[{char $\ast$}]{argv\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}



Main function for the Gameboy emulator. This function initializes the emulator by setting various parameters and calling the necessary initialization functions. It also loads a ROM file if passed as a command-\/line argument, otherwise it prompts the user to select a ROM file. Finally, it runs the emulator by calling the \mbox{\hyperlink{gameboy_8h_a81597fe9593afa9524041c128e8c9517}{run\+Emul()}} function and returns 0 when finished. 


\begin{DoxyParams}{Parameters}
{\em argc} & The number of command-\/line arguments passed to the program. \\
\hline
{\em argv} & An array of command-\/line argument strings. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An integer indicating the success of the program (always returns 0). 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{main_8cpp_source_l00284}{284}} of file \mbox{\hyperlink{main_8cpp_source}{main.\+cpp}}.

\mbox{\Hypertarget{main_8cpp_a54add63a62b11f9bccd4975da8fdd99c}\label{main_8cpp_a54add63a62b11f9bccd4975da8fdd99c}} 
\index{main.cpp@{main.cpp}!selectRom@{selectRom}}
\index{selectRom@{selectRom}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{selectRom()}{selectRom()}}
{\footnotesize\ttfamily void select\+Rom (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Loads a ROM file and initializes the Gameboy emulator for the first time. 

This function unloads the current ROM, displays a file chooser dialog to let the user select a new ROM file to load, and initializes the emulator with the selected ROM. If a BIOS file is present, it is loaded and used by the emulator as well.

\begin{DoxyNote}{Note}
This function must be called after the emulator has been initialized at least once. 
\end{DoxyNote}


Definition at line \mbox{\hyperlink{main_8cpp_source_l00083}{83}} of file \mbox{\hyperlink{main_8cpp_source}{main.\+cpp}}.



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{main_8cpp_ad0ebda86ffac57ba19597a1233125129}\label{main_8cpp_ad0ebda86ffac57ba19597a1233125129}} 
\index{main.cpp@{main.cpp}!lastRawTime@{lastRawTime}}
\index{lastRawTime@{lastRawTime}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{lastRawTime}{lastRawTime}}
{\footnotesize\ttfamily time\+\_\+t last\+Raw\+Time\hspace{0.3cm}{\ttfamily [extern]}}



Definition at line \mbox{\hyperlink{gameboy_8cpp_source_l00023}{23}} of file \mbox{\hyperlink{gameboy_8cpp_source}{gameboy.\+cpp}}.

\mbox{\Hypertarget{main_8cpp_a2e99c78e3943a1e70d5e79a314aee490}\label{main_8cpp_a2e99c78e3943a1e70d5e79a314aee490}} 
\index{main.cpp@{main.cpp}!rawTime@{rawTime}}
\index{rawTime@{rawTime}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{rawTime}{rawTime}}
{\footnotesize\ttfamily time\+\_\+t raw\+Time\hspace{0.3cm}{\ttfamily [extern]}}



Definition at line \mbox{\hyperlink{gameboy_8cpp_source_l00022}{22}} of file \mbox{\hyperlink{gameboy_8cpp_source}{gameboy.\+cpp}}.

\mbox{\Hypertarget{main_8cpp_a2bb32c52cb5d21be737aaa2aefb353d4}\label{main_8cpp_a2bb32c52cb5d21be737aaa2aefb353d4}} 
\index{main.cpp@{main.cpp}!sharedData@{sharedData}}
\index{sharedData@{sharedData}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{sharedData}{sharedData}}
{\footnotesize\ttfamily volatile \mbox{\hyperlink{struct_shared_data}{Shared\+Data}}$\ast$ shared\+Data}



Definition at line \mbox{\hyperlink{main_8cpp_source_l00027}{27}} of file \mbox{\hyperlink{main_8cpp_source}{main.\+cpp}}.

