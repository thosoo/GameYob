\hypertarget{gbs_8cpp_source}{}\doxysection{gbs.\+cpp}
\label{gbs_8cpp_source}\index{arm9/source/gbs.cpp@{arm9/source/gbs.cpp}}
\mbox{\hyperlink{gbs_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00001}00001\ \textcolor{comment}{//\ GBS\ files\ contain\ music\ ripped\ from\ a\ game.}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00002}00002\ \textcolor{preprocessor}{\#include\ <nds.h>}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00003}00003\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{gbs_8h}{gbs.h}}"{}}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00004}00004\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{common_8h}{common.h}}"{}}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00005}00005\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{inputhelper_8h}{inputhelper.h}}"{}}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00006}00006\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{mmu_8h}{mmu.h}}"{}}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00007}00007\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{gbcpu_8h}{gbcpu.h}}"{}}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00008}00008\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{gameboy_8h}{gameboy.h}}"{}}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00009}00009\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{main_8h}{main.h}}"{}}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00010}00010\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{gbsnd_8h}{gbsnd.h}}"{}}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00011}00011\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{console_8h}{console.h}}"{}}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00013}\mbox{\hyperlink{gbs_8cpp_aa9a35836492b7b901d60cb746eca10ab}{00013}}\ \textcolor{preprocessor}{\#define\ READ16(src)\ (*(src)\ |\ *(src\ +\ 1)\ <<\ 8)}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00014}00014\ }
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00015}\mbox{\hyperlink{gbs_8h_a6e7048c5efaac6e4916711ad174944cd}{00015}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{gbs_8cpp_a6e7048c5efaac6e4916711ad174944cd}{gbsMode}};}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00016}\mbox{\hyperlink{gbs_8h_ac0bac384f753cca98e4b319e66197d23}{00016}}\ u8\ \mbox{\hyperlink{gbs_8cpp_ac0bac384f753cca98e4b319e66197d23}{gbsHeader}}[0x70];}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00018}\mbox{\hyperlink{gbs_8h_a338072ed93ced41ed1b6232e4fc99f20}{00018}}\ u8\ \mbox{\hyperlink{gbs_8cpp_a338072ed93ced41ed1b6232e4fc99f20}{gbsNumSongs}};}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00019}\mbox{\hyperlink{gbs_8h_a0daba745c8a0722d6e31d5e80e7a0fd1}{00019}}\ u16\ \mbox{\hyperlink{gbs_8cpp_a0daba745c8a0722d6e31d5e80e7a0fd1}{gbsLoadAddress}};}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00020}\mbox{\hyperlink{gbs_8h_a0e2cffbed8493c14db1ded55395af8cf}{00020}}\ u16\ \mbox{\hyperlink{gbs_8cpp_a0e2cffbed8493c14db1ded55395af8cf}{gbsInitAddress}};}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00021}\mbox{\hyperlink{gbs_8h_a9bbb97c3a404d267c6831ad62c352421}{00021}}\ u16\ \mbox{\hyperlink{gbs_8cpp_a9bbb97c3a404d267c6831ad62c352421}{gbsPlayAddress}};}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00023}\mbox{\hyperlink{gbs_8cpp_a33d532274d92f42955d87099e3f3bf01}{00023}}\ u8\ \mbox{\hyperlink{gbs_8cpp_a33d532274d92f42955d87099e3f3bf01}{gbsSelectedSong}};}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00024}\mbox{\hyperlink{gbs_8cpp_a00a26d4fbcaa8ac47c72913cb2550882}{00024}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{gbs_8cpp_a00a26d4fbcaa8ac47c72913cb2550882}{gbsPlayingSong}};}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00025}00025\ }
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00026}\mbox{\hyperlink{gbs_8cpp_a8f4928376be33912f91d88f4e4f25144}{00026}}\ PrintConsole\ *\mbox{\hyperlink{gbs_8cpp_a8f4928376be33912f91d88f4e4f25144}{gbsConsole}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00027}00027\ \textcolor{keyword}{extern}\ PrintConsole\ \mbox{\hyperlink{gbs_8cpp_a26933da88e134b45bd2622bef71566f3}{defaultConsole}};\ \textcolor{comment}{//\ Defined\ in\ libnds}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00028}00028\ }
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00029}00029\ \textcolor{comment}{//\ private}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00030}00030\ }
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00031}\mbox{\hyperlink{gbs_8cpp_a8b0c7a47e3275ba841a9ada435182303}{00031}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{gbs_8cpp_a8b0c7a47e3275ba841a9ada435182303}{gbsRedraw}}()}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00032}00032\ \{}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00033}00033\ \ \ \ \ \textcolor{comment}{//\ consoleClear();}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00034}00034\ }
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00035}00035\ \ \ \ \ PrintConsole\ *oldPrintConsole\ =\ \mbox{\hyperlink{console_8h_a74f4527cb67b8d6676eacb30ed7af289}{getPrintConsole}}();}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00036}00036\ \ \ \ \ \mbox{\hyperlink{console_8h_a295722636648521691f4dc6fbe0646df}{setPrintConsole}}(\mbox{\hyperlink{gbs_8cpp_a8f4928376be33912f91d88f4e4f25144}{gbsConsole}});}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00037}00037\ \ \ \ \ iprintf(\textcolor{stringliteral}{"{}\(\backslash\)33[0;0H"{}});\ \textcolor{comment}{//\ Cursor\ to\ upper-\/left\ corner}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00038}00038\ }
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00039}00039\ \ \ \ \ iprintf(\textcolor{stringliteral}{"{}Song\ \%d\ of\ \%d\(\backslash\)33[0K\(\backslash\)n"{}},\ \mbox{\hyperlink{gbs_8cpp_a33d532274d92f42955d87099e3f3bf01}{gbsSelectedSong}}\ +\ 1,\ \mbox{\hyperlink{gbs_8cpp_a338072ed93ced41ed1b6232e4fc99f20}{gbsNumSongs}});}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00040}00040\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{gbs_8cpp_a00a26d4fbcaa8ac47c72913cb2550882}{gbsPlayingSong}}\ ==\ -\/1)}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00041}00041\ \ \ \ \ \ \ \ \ iprintf(\textcolor{stringliteral}{"{}(Not\ playing)\(\backslash\)33[0K\(\backslash\)n\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00042}00042\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00043}00043\ \ \ \ \ \ \ \ \ iprintf(\textcolor{stringliteral}{"{}(Playing\ \%d)\(\backslash\)33[0K\(\backslash\)n\(\backslash\)n"{}},\ \mbox{\hyperlink{gbs_8cpp_a00a26d4fbcaa8ac47c72913cb2550882}{gbsPlayingSong}}\ +\ 1);}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00044}00044\ }
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00045}00045\ \ \ \ \ \textcolor{comment}{//\ Print\ music\ information}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00046}00046\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ 3;\ i++)}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00047}00047\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00048}00048\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ 32;\ j++)}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00049}00049\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00050}00050\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ c\ =\ \mbox{\hyperlink{gbs_8cpp_ac0bac384f753cca98e4b319e66197d23}{gbsHeader}}[0x10\ +\ i\ *\ 0x20\ +\ j];}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00051}00051\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (c\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00052}00052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ iprintf(\textcolor{stringliteral}{"{}\ "{}});}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00053}00053\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00054}00054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ iprintf(\textcolor{stringliteral}{"{}\%c"{}},\ c);}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00055}00055\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00056}00056\ \ \ \ \ \ \ \ \ iprintf(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00057}00057\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00058}00058\ \ \ \ \ \mbox{\hyperlink{console_8h_a295722636648521691f4dc6fbe0646df}{setPrintConsole}}(oldPrintConsole);}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00059}00059\ \}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00060}00060\ }
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00061}\mbox{\hyperlink{gbs_8cpp_a0f14d5fbca26efc9e176e9a49d1ecb8b}{00061}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{gbs_8cpp_a0f14d5fbca26efc9e176e9a49d1ecb8b}{gbsLoadSong}}()}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00062}00062\ \{}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00063}00063\ \ \ \ \ \mbox{\hyperlink{mmu_8h_a1660bd805506c41836f415364b20440b}{initMMU}}();}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00064}00064\ \ \ \ \ \mbox{\hyperlink{gbcpu_8h_a8889a71b1ce95f894a45758861ff1361}{ime}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00065}00065\ }
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00066}00066\ \ \ \ \ \mbox{\hyperlink{gbcpu_8h_ae419d75b68e531a5f8051701aa4c7bf5}{gbRegs}}.\mbox{\hyperlink{struct_registers_a51227a710f1d390acb79ce8158f7f5aa}{sp}}.\mbox{\hyperlink{union_register_a561bf5d9b7682fff3ec2bfda04365452}{w}}\ =\ \mbox{\hyperlink{gbs_8cpp_aa9a35836492b7b901d60cb746eca10ab}{READ16}}(\mbox{\hyperlink{gbs_8cpp_ac0bac384f753cca98e4b319e66197d23}{gbsHeader}}\ +\ 0x0c);}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00067}00067\ \ \ \ \ u8\ tma\ =\ \mbox{\hyperlink{gbs_8cpp_ac0bac384f753cca98e4b319e66197d23}{gbsHeader}}[0x0e];}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00068}00068\ \ \ \ \ u8\ tac\ =\ \mbox{\hyperlink{gbs_8cpp_ac0bac384f753cca98e4b319e66197d23}{gbsHeader}}[0x0f];}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00069}00069\ }
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00070}00070\ \ \ \ \ \textcolor{keywordflow}{if}\ (tac\ \&\ 0x80)}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00071}00071\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{gameboy_8h_a362b36e2946a997e3fd48ced932c5477}{setDoubleSpeed}}(1);}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00072}00072\ \ \ \ \ tac\ \&=\ \string~0x80;}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00073}00073\ \ \ \ \ \textcolor{keywordflow}{if}\ (tma\ ==\ 0\ \&\&\ tac\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00074}00074\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00075}00075\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Vblank\ interrupt\ handler}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00076}00076\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{inputhelper_8h_ab4926433311d08ecb615d83f8f124e23}{romSlot0}}[0x40]\ =\ 0xcd;\ \textcolor{comment}{//\ call}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00077}00077\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{inputhelper_8h_ab4926433311d08ecb615d83f8f124e23}{romSlot0}}[0x41]\ =\ \mbox{\hyperlink{gbs_8cpp_a9bbb97c3a404d267c6831ad62c352421}{gbsPlayAddress}}\ \&\ 0xff;}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00078}00078\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{inputhelper_8h_ab4926433311d08ecb615d83f8f124e23}{romSlot0}}[0x42]\ =\ \mbox{\hyperlink{gbs_8cpp_a9bbb97c3a404d267c6831ad62c352421}{gbsPlayAddress}}\ >>\ 8;}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00079}00079\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{inputhelper_8h_ab4926433311d08ecb615d83f8f124e23}{romSlot0}}[0x43]\ =\ 0xd9;\ \textcolor{comment}{//\ reti}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00080}00080\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mmu_8h_acf23f43365192603962a5b11716d0102}{writeIO}}(0xff,\ \mbox{\hyperlink{global_8h_a0626a5926d1d4bb803aa989065220b96}{VBLANK}});}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00081}00081\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00082}00082\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00083}00083\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00084}00084\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Timer\ interrupt\ handler}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00085}00085\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{inputhelper_8h_ab4926433311d08ecb615d83f8f124e23}{romSlot0}}[0x50]\ =\ 0xcd;\ \textcolor{comment}{//\ call}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00086}00086\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{inputhelper_8h_ab4926433311d08ecb615d83f8f124e23}{romSlot0}}[0x51]\ =\ \mbox{\hyperlink{gbs_8cpp_a9bbb97c3a404d267c6831ad62c352421}{gbsPlayAddress}}\ \&\ 0xff;}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00087}00087\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{inputhelper_8h_ab4926433311d08ecb615d83f8f124e23}{romSlot0}}[0x52]\ =\ \mbox{\hyperlink{gbs_8cpp_a9bbb97c3a404d267c6831ad62c352421}{gbsPlayAddress}}\ >>\ 8;}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00088}00088\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{inputhelper_8h_ab4926433311d08ecb615d83f8f124e23}{romSlot0}}[0x53]\ =\ 0xd9;\ \textcolor{comment}{//\ reti}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00089}00089\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mmu_8h_acf23f43365192603962a5b11716d0102}{writeIO}}(0xff,\ \mbox{\hyperlink{global_8h_a599217205dc3092c26567a2bd868ef3a}{TIMER}});}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00090}00090\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00091}00091\ }
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00092}00092\ \ \ \ \ \mbox{\hyperlink{mmu_8h_acf23f43365192603962a5b11716d0102}{writeIO}}(0x05,\ 0x00);}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00093}00093\ \ \ \ \ \mbox{\hyperlink{mmu_8h_acf23f43365192603962a5b11716d0102}{writeIO}}(0x06,\ tma);}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00094}00094\ \ \ \ \ \mbox{\hyperlink{mmu_8h_acf23f43365192603962a5b11716d0102}{writeIO}}(0x07,\ tac);}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00095}00095\ }
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00096}00096\ \ \ \ \ \mbox{\hyperlink{gbs_8cpp_a00a26d4fbcaa8ac47c72913cb2550882}{gbsPlayingSong}}\ =\ \mbox{\hyperlink{gbs_8cpp_a33d532274d92f42955d87099e3f3bf01}{gbsSelectedSong}};}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00097}00097\ \ \ \ \ \mbox{\hyperlink{gbcpu_8h_ae419d75b68e531a5f8051701aa4c7bf5}{gbRegs}}.\mbox{\hyperlink{struct_registers_aad6bbc5ebe190ec3bee972e46a59e615}{af}}.\mbox{\hyperlink{union_register_a9c98442c30c45ade6b9841dbac176c6d}{b}}.\mbox{\hyperlink{struct_register_1_1_b_aaa1aed0044076a032052906e5f7ba271}{h}}\ =\ \mbox{\hyperlink{gbs_8cpp_a00a26d4fbcaa8ac47c72913cb2550882}{gbsPlayingSong}};}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00098}00098\ \ \ \ \ \mbox{\hyperlink{mmu_8h_a3e4ce4b7fa59a8e7784a6665e2f8f588}{writeMemory}}(-\/-\/\mbox{\hyperlink{gbcpu_8h_ae419d75b68e531a5f8051701aa4c7bf5}{gbRegs}}.\mbox{\hyperlink{struct_registers_a51227a710f1d390acb79ce8158f7f5aa}{sp}}.\mbox{\hyperlink{union_register_a561bf5d9b7682fff3ec2bfda04365452}{w}},\ 0x01);}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00099}00099\ \ \ \ \ \mbox{\hyperlink{mmu_8h_a3e4ce4b7fa59a8e7784a6665e2f8f588}{writeMemory}}(-\/-\/\mbox{\hyperlink{gbcpu_8h_ae419d75b68e531a5f8051701aa4c7bf5}{gbRegs}}.\mbox{\hyperlink{struct_registers_a51227a710f1d390acb79ce8158f7f5aa}{sp}}.\mbox{\hyperlink{union_register_a561bf5d9b7682fff3ec2bfda04365452}{w}},\ 0x00);\ \textcolor{comment}{//\ Will\ return\ to\ beginning}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00100}00100\ \ \ \ \ \mbox{\hyperlink{gbcpu_8h_ae419d75b68e531a5f8051701aa4c7bf5}{gbRegs}}.\mbox{\hyperlink{struct_registers_a9290eb9afad5ad8caf5e7d981bed1d9a}{pc}}.\mbox{\hyperlink{union_register_a561bf5d9b7682fff3ec2bfda04365452}{w}}\ =\ \mbox{\hyperlink{gbs_8cpp_a0e2cffbed8493c14db1ded55395af8cf}{gbsInitAddress}};}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00101}00101\ \}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00102}00102\ }
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00103}00103\ \textcolor{comment}{//\ public}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00104}00104\ }
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00105}\mbox{\hyperlink{gbs_8h_a434edf584594d5aac0737f0b5293c6b8}{00105}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{gbs_8cpp_a434edf584594d5aac0737f0b5293c6b8}{gbsReadHeader}}()}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00106}00106\ \{}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00107}00107\ \ \ \ \ \mbox{\hyperlink{gbs_8cpp_a338072ed93ced41ed1b6232e4fc99f20}{gbsNumSongs}}\ =\ \mbox{\hyperlink{gbs_8cpp_ac0bac384f753cca98e4b319e66197d23}{gbsHeader}}[0x04];}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00108}00108\ \ \ \ \ \mbox{\hyperlink{gbs_8cpp_a0daba745c8a0722d6e31d5e80e7a0fd1}{gbsLoadAddress}}\ =\ \mbox{\hyperlink{gbs_8cpp_aa9a35836492b7b901d60cb746eca10ab}{READ16}}(\mbox{\hyperlink{gbs_8cpp_ac0bac384f753cca98e4b319e66197d23}{gbsHeader}}\ +\ 0x06);}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00109}00109\ \ \ \ \ \mbox{\hyperlink{gbs_8cpp_a0e2cffbed8493c14db1ded55395af8cf}{gbsInitAddress}}\ =\ \mbox{\hyperlink{gbs_8cpp_aa9a35836492b7b901d60cb746eca10ab}{READ16}}(\mbox{\hyperlink{gbs_8cpp_ac0bac384f753cca98e4b319e66197d23}{gbsHeader}}\ +\ 0x08);}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00110}00110\ \ \ \ \ \mbox{\hyperlink{gbs_8cpp_a9bbb97c3a404d267c6831ad62c352421}{gbsPlayAddress}}\ =\ \mbox{\hyperlink{gbs_8cpp_aa9a35836492b7b901d60cb746eca10ab}{READ16}}(\mbox{\hyperlink{gbs_8cpp_ac0bac384f753cca98e4b319e66197d23}{gbsHeader}}\ +\ 0x0a);}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00111}00111\ \}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00112}00112\ }
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00113}\mbox{\hyperlink{gbs_8h_a369dd14d3b470e7277401596f1eab7b6}{00113}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{gbs_8cpp_a369dd14d3b470e7277401596f1eab7b6}{gbsInit}}()}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00114}00114\ \{}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00115}00115\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{gbs_8cpp_a8f4928376be33912f91d88f4e4f25144}{gbsConsole}}\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00116}00116\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00117}00117\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{gbs_8cpp_a8f4928376be33912f91d88f4e4f25144}{gbsConsole}}\ =\ (PrintConsole\ *)malloc(\textcolor{keyword}{sizeof}(PrintConsole));}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00118}00118\ \ \ \ \ \ \ \ \ memcpy(\mbox{\hyperlink{gbs_8cpp_a8f4928376be33912f91d88f4e4f25144}{gbsConsole}},\ \&\mbox{\hyperlink{gbs_8cpp_a26933da88e134b45bd2622bef71566f3}{defaultConsole}},\ \textcolor{keyword}{sizeof}(PrintConsole));}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00119}00119\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00120}00120\ \ \ \ \ videoSetMode(MODE\_0\_2D);}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00121}00121\ \ \ \ \ consoleInit(\mbox{\hyperlink{gbs_8cpp_a8f4928376be33912f91d88f4e4f25144}{gbsConsole}},\ \mbox{\hyperlink{gbs_8cpp_a8f4928376be33912f91d88f4e4f25144}{gbsConsole}}-\/>bgLayer,\ BgType\_Text4bpp,\ BgSize\_T\_256x256,\ \mbox{\hyperlink{gbs_8cpp_a8f4928376be33912f91d88f4e4f25144}{gbsConsole}}-\/>mapBase,\ \mbox{\hyperlink{gbs_8cpp_a8f4928376be33912f91d88f4e4f25144}{gbsConsole}}-\/>gfxBase,\ \textcolor{keyword}{true},\ \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00122}00122\ \ \ \ \ \mbox{\hyperlink{console_8h_a295722636648521691f4dc6fbe0646df}{setPrintConsole}}(\mbox{\hyperlink{gbs_8cpp_a8f4928376be33912f91d88f4e4f25144}{gbsConsole}});}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00123}00123\ \ \ \ \ videoBgEnable(0);}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00124}00124\ }
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00125}00125\ \ \ \ \ u8\ firstSong\ =\ \mbox{\hyperlink{gbs_8cpp_ac0bac384f753cca98e4b319e66197d23}{gbsHeader}}[0x05]\ -\/\ 1;}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00126}00126\ }
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00127}00127\ \ \ \ \ \textcolor{comment}{//\ RST\ vectors}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00128}00128\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ 8;\ i++)}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00129}00129\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00130}00130\ \ \ \ \ \ \ \ \ u16\ dest\ =\ \mbox{\hyperlink{gbs_8cpp_a0daba745c8a0722d6e31d5e80e7a0fd1}{gbsLoadAddress}}\ +\ i\ *\ 8;}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00131}00131\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{inputhelper_8h_ab4926433311d08ecb615d83f8f124e23}{romSlot0}}[i\ *\ 8]\ =\ 0xc3;\ \textcolor{comment}{//\ jp}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00132}00132\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{inputhelper_8h_ab4926433311d08ecb615d83f8f124e23}{romSlot0}}[i\ *\ 8\ +\ 1]\ =\ dest\ \&\ 0xff;}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00133}00133\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{inputhelper_8h_ab4926433311d08ecb615d83f8f124e23}{romSlot0}}[i\ *\ 8\ +\ 2]\ =\ dest\ >>\ 8;}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00134}00134\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00135}00135\ }
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00136}00136\ \ \ \ \ \textcolor{comment}{//\ Interrupt\ handlers}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00137}00137\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ 5;\ i++)}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00138}00138\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00139}00139\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{inputhelper_8h_ab4926433311d08ecb615d83f8f124e23}{romSlot0}}[0x40\ +\ i\ *\ 8]\ =\ 0xd9;\ \textcolor{comment}{//\ reti}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00140}00140\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00141}00141\ }
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00142}00142\ \ \ \ \ \textcolor{comment}{//\ Infinite\ loop}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00143}00143\ \ \ \ \ \mbox{\hyperlink{inputhelper_8h_ab4926433311d08ecb615d83f8f124e23}{romSlot0}}[0x100]\ =\ 0xfb;\ \textcolor{comment}{//\ ime}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00144}00144\ \ \ \ \ \mbox{\hyperlink{inputhelper_8h_ab4926433311d08ecb615d83f8f124e23}{romSlot0}}[0x101]\ =\ 0x76;\ \textcolor{comment}{//\ halt}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00145}00145\ \ \ \ \ \mbox{\hyperlink{inputhelper_8h_ab4926433311d08ecb615d83f8f124e23}{romSlot0}}[0x102]\ =\ 0x18;\ \textcolor{comment}{//\ jr\ -\/3}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00146}00146\ \ \ \ \ \mbox{\hyperlink{inputhelper_8h_ab4926433311d08ecb615d83f8f124e23}{romSlot0}}[0x103]\ =\ -\/3;}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00147}00147\ }
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00148}00148\ \ \ \ \ \mbox{\hyperlink{gbs_8cpp_a33d532274d92f42955d87099e3f3bf01}{gbsSelectedSong}}\ =\ firstSong;}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00149}00149\ \ \ \ \ \mbox{\hyperlink{gbs_8cpp_a0f14d5fbca26efc9e176e9a49d1ecb8b}{gbsLoadSong}}();}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00150}00150\ \}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00151}00151\ }
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00152}00152\ \textcolor{comment}{//\ Called\ at\ vblank\ each\ frame}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00153}\mbox{\hyperlink{gbs_8h_ad8052480bdc750a0c994e2835d0c40f8}{00153}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{gbs_8cpp_ad8052480bdc750a0c994e2835d0c40f8}{gbsCheckInput}}()}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00154}00154\ \{}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00155}00155\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{inputhelper_8h_a99d5423f8f0dc71b84a16d56a51f8e9a}{keyPressedAutoRepeat}}(\mbox{\hyperlink{inputhelper_8h_adea147396571230af47a2b52caa970b3}{mapGbKey}}(\mbox{\hyperlink{inputhelper_8h_a61dadd085c1777f559549e05962b2c9ea4b2e341451e26e0e93073a01b2f53a99}{KEY\_GB\_LEFT}})))}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00156}00156\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00157}00157\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{gbs_8cpp_a33d532274d92f42955d87099e3f3bf01}{gbsSelectedSong}}\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00158}00158\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{gbs_8cpp_a33d532274d92f42955d87099e3f3bf01}{gbsSelectedSong}}\ =\ \mbox{\hyperlink{gbs_8cpp_a338072ed93ced41ed1b6232e4fc99f20}{gbsNumSongs}}\ -\/\ 1;}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00159}00159\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00160}00160\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{gbs_8cpp_a33d532274d92f42955d87099e3f3bf01}{gbsSelectedSong}}-\/-\/;}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00161}00161\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00162}00162\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{inputhelper_8h_a99d5423f8f0dc71b84a16d56a51f8e9a}{keyPressedAutoRepeat}}(\mbox{\hyperlink{inputhelper_8h_adea147396571230af47a2b52caa970b3}{mapGbKey}}(\mbox{\hyperlink{inputhelper_8h_a61dadd085c1777f559549e05962b2c9ea338cffadee195ddc56fbcc776c903290}{KEY\_GB\_RIGHT}})))}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00163}00163\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00164}00164\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{gbs_8cpp_a33d532274d92f42955d87099e3f3bf01}{gbsSelectedSong}}++;}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00165}00165\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{gbs_8cpp_a33d532274d92f42955d87099e3f3bf01}{gbsSelectedSong}}\ ==\ \mbox{\hyperlink{gbs_8cpp_a338072ed93ced41ed1b6232e4fc99f20}{gbsNumSongs}})}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00166}00166\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{gbs_8cpp_a33d532274d92f42955d87099e3f3bf01}{gbsSelectedSong}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00167}00167\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00168}00168\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{inputhelper_8h_a02a774508142e40a6364db3bc1b4c4ee}{keyJustPressed}}(\mbox{\hyperlink{inputhelper_8h_adea147396571230af47a2b52caa970b3}{mapGbKey}}(\mbox{\hyperlink{inputhelper_8h_a61dadd085c1777f559549e05962b2c9ea962f7f6d8022e74f3f8daeb583325f77}{KEY\_GB\_A}})))}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00169}00169\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00170}00170\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{gbs_8cpp_a0f14d5fbca26efc9e176e9a49d1ecb8b}{gbsLoadSong}}();}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00171}00171\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00172}00172\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{inputhelper_8h_a02a774508142e40a6364db3bc1b4c4ee}{keyJustPressed}}(\mbox{\hyperlink{inputhelper_8h_adea147396571230af47a2b52caa970b3}{mapGbKey}}(\mbox{\hyperlink{inputhelper_8h_a61dadd085c1777f559549e05962b2c9eaa04f27511f218cae4ed97375b2ef4d00}{KEY\_GB\_B}})))}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00173}00173\ \ \ \ \ \{\ \textcolor{comment}{//\ Stop\ playing\ music}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00174}00174\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{gbs_8cpp_a00a26d4fbcaa8ac47c72913cb2550882}{gbsPlayingSong}}\ =\ -\/1;}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00175}00175\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{gbcpu_8h_a8889a71b1ce95f894a45758861ff1361}{ime}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00176}00176\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mmu_8h_acf23f43365192603962a5b11716d0102}{writeIO}}(0xff,\ 0);}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00177}00177\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{gbsnd_8h_a15114ef6911222770c38408ae365c6bd}{initSND}}();}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00178}00178\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00179}00179\ \ \ \ \ \mbox{\hyperlink{gbs_8cpp_a8b0c7a47e3275ba841a9ada435182303}{gbsRedraw}}();}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00180}00180\ }
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00181}00181\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{gbs_8cpp_a00a26d4fbcaa8ac47c72913cb2550882}{gbsPlayingSong}}\ !=\ -\/1)}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00182}00182\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{console_8h_a60483e1d9c79534c8c4d71cb98654907}{disableSleepMode}}();}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00183}00183\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00184}00184\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{console_8h_a50a69c022725d0b54985ee39f399b45f}{enableSleepMode}}();}
\DoxyCodeLine{\Hypertarget{gbs_8cpp_source_l00185}00185\ \}}

\end{DoxyCode}
